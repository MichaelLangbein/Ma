\section{Tensorflow}

\subsection{Low-level API}

Working with tf always entails a two-step process. First, define a graph, and second, execute it. 

\begin{lstlisting}[language=python]
import tensorflow as tf

# Step 1: define a graph
a = tf.Variable(initial_value=2)
b = tf.Variable(initial_value=3)
c = a * b

# Step 2: execute graph
with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    result = sess.run(c)
    print(result)

\end{lstlisting}

\emph{Running} a tensor means evaluating it - in the case of \inlinecode{c}, that means calculating \inlinecode{a * b}.
There are two things that can be run by a session: tensors (to be evaluated) and operations (to be executed). 

Tf is declarative: \inlinecode{c = a*b} does not return the result of the multiplication of a and b, but a tensor that is still waiting to be evaluated. 
This can make debuggung pretty hard, though. For debugging, we'd like tf to behave more imperatively, where every expression is immediately evaluated. 
We can acchieve this by using an interactive session, where every tensor can be evaluated immediately by calling \inlinecode{eval()}:
\begin{lstlisting}[language=python]
    sess = tf.InteractiveSession()
    c.eval()
\end{lstlisting}

Optimizers are a very common example of operations, so we show a very simple example of their usage.

\begin{lstlisting}[language=python]
import tensorflow as tf
import numpy as np

# Step 0: Data
a = 0.2
b = 5
xs_training = np.random.random(100) * 100
ys_training = a*xs_training + b + np.random.random(100)
xs_validation = np.random.random(100) * 100
ys_validation = a*xs_validation + b + np.random.random(100)

# Step 1: define model
a_tf = tf.Variable(0.3421)
b_tf = tf.Variable(0.41)
prediction_tf = a_tf * xs_training + b_tf
loss_tf = tf.reduce_sum((ys_training - prediction_tf)**2)
optimizer = tf.train.GradientDescentOptimizer(0.1)
training_operation = optimizer.minimize(loss_tf, var_list=[a_tf, b_tf])

# Step 2: execute model
with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    for i in range(10):
        results = sess.run([training_operation, a_tf, b_tf])
        print(results)


\end{lstlisting}